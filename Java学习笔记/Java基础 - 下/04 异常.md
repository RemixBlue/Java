# 异常
## 主要内容

- 异常

## **第一章 异常**

## 1. 1 异常概念

异常，就是不正常的意思。

* **异常** ：指的是程序在执行过程中，出现的非正常的情况，最终会导致JVM的非正常停止。

在Java等面向对象的编程语言中，异常本身是一个类，产生异常就是创建异常对象并抛出了一个异常对象。Java处理异常的方式是中断处理。

> 异常指的并不是语法错误,语法错了,编译不通过,不会产生字节码文件,根本不能运行.

## 1.2 异常体系

异常机制其实是帮助我们**找到**程序中的问题，异常的根类是`java.lang.Throwable`，其下有两个子类：`java.lang.Error`与`java.lang.Exception`，平常所说的异常指`java.lang.Exception`。

**Throwable 体系：**

* **Error** : 严重错误Error，无法通过处理的错误，只能事先避免。
* **Exception** : 表示异常，异常产生后程序员可以通过代码的方式纠正，使程序继续运行，是必须要处理的。

**Throwable 中的常用方法：**

* `public void printStackTrace()` : 打印异常的详细信息。

  包含了异常的类型,异常的原因,还包括异常出现的位置,在开发和调试阶段,都得使用printStackTrace。

* `public String getMessage()` : 获取发生异常的原因。

  提示给用户的时候,就提示错误原因。

* `public String toString()`:获取异常的类型和异常描述信息(不用)。

**出现异常,不要紧张,把异常的简单类名,拷贝到API中去查。**

## 1. 3 异常分类

平常说的异常就是指`Exception` ，因为这类异常一旦出现，我们就要对代码进行更正，修复程序。

**异常(Exception)的分类** : 根据在编译时期还是运行时期去检查异常?

* **编译时期异常** : `checked` 异常。在编译时期,就会检查,如果没有处理异常,则编译失败。(如日期格式化异常)
* **运行时期异常** : `runtime` 异常。在运行时期,检查异常.在编译时期,运行异常不会编译器检测(不报错)。(如数学异常)
---
## **第二章 异常的处理**

Java异常处理的五个关键字：**`try`、`catch`、`finally`、`throw`、`throws`**

## 2. 1 	抛出异常 `throw`

在编写程序时，必须要考虑程序出现问题的情况。

比如，在定义方法时，方法需要接受参数。那么，当调用方法使用接受到的参数时，首先需要先对参数数据进行合法的判断，数据若不合法，就应该告诉调用者，传递合法的数据进来。这时需要使用抛出异常的方式来告诉调用者。

在 java 中，提供了一个 `throw` 关键字，它用来抛出一个指定的异常对象。

抛出一个异常具体操作 ：

1. 创建一个异常对象。封装一些提示信息(信息可以自己编写)。

2. 需要将这个异常对象告知给调用者。通过关键字`throw` 将这个异常对象告知给调用者。`throw `异常对象。

   throw **用在方法内**，用来抛出一个异常对象，将这个异常对象传递到调用者处，并结束当前方法的执行。

**使用格式：**

~~~
throw new 异常类名(参数);
~~~

> 注意：如果产生了问题，就会 throw 将问题描述类即异常进行抛出，也就是将问题返回给该方法的调用者。

> 处理异常：一种是进行捕获处理，另一种就是继续讲问题声明出去，使用throws声明处理。

## 2. 2 Objects非空判断

类 `Objects` 由一些静态的实用方法组成，这些方法是null-save（空指针安全的）或null-tolerant（容忍空指针的），类 `Objects` 在源码中，对对象为null的值进行了抛出异常操作。

* `public static <T> T requireNonNull(T obj)` : 查看指定引用对象不是null。

查看源码发现这里对为null的进行了抛出异常操作：

~~~java
public static <T> T requireNonNull(T obj) {
    if (obj == null)
      	throw new NullPointerException();
    return obj;
}
~~~

## 2. 3  声明异常`throws`

**声明异常** ：将问题标识出来，报告给调用者。如果方法内通过throw抛出了编译时异常，而没有捕获处理（稍后讲解该方式），那么必须通过throws进行声明，让调用者去处理。

关键字 `throws` 运用于方法声明之上,用于表示当前方法不处理异常,而是提醒该方法的调用者来处理异常(抛出异常).

**声明异常格式：**

~~~
修饰符 返回值类型 方法名(参数) throws 异常类名1,异常类名2 …{   }	
~~~
throws用于进行异常类的声明，若该方法可能有多种异常情况产生，那么在throws后面可以写多个异常类，用逗号隔开。

## 2. 4  捕获异常`try…catch`

如果异常出现的话,会立刻终止程序,所以需要处理异常:

1. 该方法不处理,而是声明抛出,由该方法的调用者来处理( `throws` )。
2. 在方法中使用 `try-catch` 的语句块来处理异常。

**try-catch** 的方式就是捕获异常。

* **捕获异常**：Java中对异常有针对性的语句进行捕获，可以对出现的异常进行指定方式的处理。

捕获异常语法如下：

~~~java
try{
     编写可能会出现异常的代码
}catch(异常类型  e){
     处理异常的代码
     //记录日志/打印异常信息/继续抛出异常
}
~~~

`try`：该代码块中编写可能产生异常的代码。

`catch`：用来进行某种异常的捕获，实现对捕获到的异常进行处理。

> 注意 : `try` 和 `catch` 都不能单独使用,必须连用。

如何获取异常信息：

`Throwable `类中定义了一些查看方法:

* `public String getMessage()` : 获取异常的描述信息,原因(提示给用户的时候,就提示错误原因)。


* `public String toString()` : 获取异常的类型和异常描述信息(不用)。
* `public void printStackTrace()` : 打印异常的跟踪栈信息并输出到控制台。

包含了异常的类型,异常的原因,还包括异常出现的位置,在开发和调试阶段,都得使用printStackTrace。

## 2. 4 `finally` 代码块

**`finally`** ：有一些特定的代码无论异常是否发生，都需要执行。另外，因为异常会引发程序跳转，导致有些语句执行不到。而finally就是解决这个问题的，在finally代码块中存放的代码都是一定会被执行的。

什么时候的代码必须最终执行？

当在try语句块中打开了一些物理资源(磁盘文件/网络连接/数据库连接等),都需要在使用完之后,最终关闭打开的资源。

`finally` 的语法:

 `try...catch....finally` : 自身需要处理异常,最终还得关闭资源。

> 注意: `finally` 不能单独使用。


> 当只有在 `try` 或者 `catch` 中调用退出JVM的相关方法,此时 `finally` 才不会执行,否则`finally` 永远会执行。

## 2. 5   异常注意事项

* 多个异常的捕获 处理

  1. 多个异常分别处理。
  2. 多个异常一次捕获，多次处理。
  3. 多个异常一次捕获一次处理。

  一般使用一次捕获多次处理方式，格式如下：

  ```java
  try{
       编写可能会出现异常的代码
  }catch(异常类型A  e){  当try中出现A类型异常,就用该catch来捕获.
       处理异常的代码
       //记录日志/打印异常信息/继续抛出异常
  }catch(异常类型B  e){  当try中出现B类型异常,就用该catch来捕获.
       处理异常的代码
       //记录日志/打印异常信息/继续抛出异常
  }
  ```

  > 注意 : 这种异常处理方式，要求多个`catch` 中的异常不能相同，并且若`catch`中的多个异常之间有子父类异常的关系，那么子类异常要求在上面的`catch` 处理，父类异常在下面的`catch` 处理。

* 运行时异常被抛出可以不处理。即不捕获也不声明抛出。

* 如果 `finally` 有 `return` 语句,永远返回 `finally` 中的结果,避免该情况. 

* 如果父类抛出了多个异常,子类重写父类方法时,抛出和父类相同的异常或者是父类异常的子类或者不抛出异常。

* 父类方法没有抛出异常，子类重写父类该方法时也不可抛出异常。此时子类产生该异常，只能捕获处理，不能声明抛出

---
## **第三章 自定义异常**

## 3. 1 概述

**为什么需要自定义异常类 :**

Java中不同的异常类都是JDK内部定义好的，分别表示着某一种具体的异常情况，但是实际开发中也会出现很多异常，这些异常很可能在JDK中没有定义过，例如年龄负数问题，考试成绩负数问题.这个时候就需要自定义异常。

**什么是自定义异常类 ：**

在开发中根据自身业务的异常情况来定义异常类.

自定义一个业务逻辑异常: **RegisterException**。一个注册异常类。

**异常类如何定义:**

1. 自定义一个编译期异常: 自定义类 并继承于 `java.lang.Exception`。
2. 自定义一个运行时期的异常类:自定义类 并继承于 `java.lang.RuntimeException`。
---
> ps : 仅供本人学习使用
